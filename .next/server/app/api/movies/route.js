"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/movies/route";
exports.ids = ["app/api/movies/route"];
exports.modules = {

/***/ "jsdom":
/*!************************!*\
  !*** external "jsdom" ***!
  \************************/
/***/ ((module) => {

module.exports = require("jsdom");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fmovies%2Froute&page=%2Fapi%2Fmovies%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fmovies%2Froute.js&appDir=%2FUsers%2Fguzmancura%2FDesktop%2Fnextflix%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fguzmancura%2FDesktop%2Fnextflix&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fmovies%2Froute&page=%2Fapi%2Fmovies%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fmovies%2Froute.js&appDir=%2FUsers%2Fguzmancura%2FDesktop%2Fnextflix%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fguzmancura%2FDesktop%2Fnextflix&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   headerHooks: () => (/* binding */ headerHooks),\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage),\n/* harmony export */   staticGenerationBailout: () => (/* binding */ staticGenerationBailout)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Users_guzmancura_Desktop_nextflix_src_app_api_movies_route_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/movies/route.js */ \"(rsc)/./src/app/api/movies/route.js\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/movies/route\",\n        pathname: \"/api/movies\",\n        filename: \"route\",\n        bundlePath: \"app/api/movies/route\"\n    },\n    resolvedPagePath: \"/Users/guzmancura/Desktop/nextflix/src/app/api/movies/route.js\",\n    nextConfigOutput,\n    userland: _Users_guzmancura_Desktop_nextflix_src_app_api_movies_route_js__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks, headerHooks, staticGenerationBailout } = routeModule;\nconst originalPathname = \"/api/movies/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZtb3ZpZXMlMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRm1vdmllcyUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRm1vdmllcyUyRnJvdXRlLmpzJmFwcERpcj0lMkZVc2VycyUyRmd1em1hbmN1cmElMkZEZXNrdG9wJTJGbmV4dGZsaXglMkZzcmMlMkZhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPSUyRlVzZXJzJTJGZ3V6bWFuY3VyYSUyRkRlc2t0b3AlMkZuZXh0ZmxpeCZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD0mcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBc0c7QUFDdkM7QUFDYztBQUNjO0FBQzNGO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixnSEFBbUI7QUFDM0M7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxZQUFZO0FBQ1osQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLFFBQVEsdUdBQXVHO0FBQy9HO0FBQ0E7QUFDQSxXQUFXLDRFQUFXO0FBQ3RCO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDNko7O0FBRTdKIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbmV4dGZsaXgvP2VlNWMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiL1VzZXJzL2d1em1hbmN1cmEvRGVza3RvcC9uZXh0ZmxpeC9zcmMvYXBwL2FwaS9tb3ZpZXMvcm91dGUuanNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL21vdmllcy9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL21vdmllc1wiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvbW92aWVzL3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiL1VzZXJzL2d1em1hbmN1cmEvRGVza3RvcC9uZXh0ZmxpeC9zcmMvYXBwL2FwaS9tb3ZpZXMvcm91dGUuanNcIixcbiAgICBuZXh0Q29uZmlnT3V0cHV0LFxuICAgIHVzZXJsYW5kXG59KTtcbi8vIFB1bGwgb3V0IHRoZSBleHBvcnRzIHRoYXQgd2UgbmVlZCB0byBleHBvc2UgZnJvbSB0aGUgbW9kdWxlLiBUaGlzIHNob3VsZFxuLy8gYmUgZWxpbWluYXRlZCB3aGVuIHdlJ3ZlIG1vdmVkIHRoZSBvdGhlciByb3V0ZXMgdG8gdGhlIG5ldyBmb3JtYXQuIFRoZXNlXG4vLyBhcmUgdXNlZCB0byBob29rIGludG8gdGhlIHJvdXRlLlxuY29uc3QgeyByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgaGVhZGVySG9va3MsIHN0YXRpY0dlbmVyYXRpb25CYWlsb3V0IH0gPSByb3V0ZU1vZHVsZTtcbmNvbnN0IG9yaWdpbmFsUGF0aG5hbWUgPSBcIi9hcGkvbW92aWVzL3JvdXRlXCI7XG5mdW5jdGlvbiBwYXRjaEZldGNoKCkge1xuICAgIHJldHVybiBfcGF0Y2hGZXRjaCh7XG4gICAgICAgIHNlcnZlckhvb2tzLFxuICAgICAgICBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlXG4gICAgfSk7XG59XG5leHBvcnQgeyByb3V0ZU1vZHVsZSwgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIGhlYWRlckhvb2tzLCBzdGF0aWNHZW5lcmF0aW9uQmFpbG91dCwgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fmovies%2Froute&page=%2Fapi%2Fmovies%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fmovies%2Froute.js&appDir=%2FUsers%2Fguzmancura%2FDesktop%2Fnextflix%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fguzmancura%2FDesktop%2Fnextflix&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./src/app/api/movies/route.js":
/*!*************************************!*\
  !*** ./src/app/api/movies/route.js ***!
  \*************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var jsdom__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! jsdom */ \"jsdom\");\n/* harmony import */ var jsdom__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(jsdom__WEBPACK_IMPORTED_MODULE_1__);\n\n\nasync function fetchAllPages(listUrl) {\n    const allMovies = [];\n    let currentPage = 1;\n    let hasNextPage = true;\n    let retryCount = 0;\n    const maxRetries = 2;\n    const delayBetweenPages = 2000;\n    const delayBetweenRetries = 3000;\n    // Check if it's a watchlist URL\n    const isWatchlist = listUrl.includes(\"/watchlist\");\n    while(hasNextPage){\n        // Handle pagination URL format differently for watchlists\n        const pageUrl = currentPage === 1 ? listUrl : isWatchlist ? `${listUrl.replace(/\\/$/, \"\")}/page/${currentPage}/` : `${listUrl}page/${currentPage}/`;\n        console.log(\"Fetching page:\", pageUrl);\n        try {\n            if (currentPage > 1) {\n                console.log(`Waiting ${delayBetweenPages}ms before fetching next page...`);\n                await new Promise((resolve)=>setTimeout(resolve, delayBetweenPages));\n            }\n            const response = await fetch(pageUrl, {\n                headers: {\n                    \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36\",\n                    \"Accept\": \"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\",\n                    \"Accept-Language\": \"en-US,en;q=0.5\",\n                    \"Connection\": \"keep-alive\",\n                    \"Upgrade-Insecure-Requests\": \"1\",\n                    \"Cache-Control\": \"max-age=0\"\n                }\n            });\n            if (!response.ok) {\n                console.error(\"Failed to fetch page:\", pageUrl, response.status);\n                if (retryCount < maxRetries) {\n                    retryCount++;\n                    console.log(`Retrying page ${currentPage} (attempt ${retryCount}/${maxRetries})`);\n                    await new Promise((resolve)=>setTimeout(resolve, delayBetweenRetries));\n                    continue;\n                }\n                console.log(\"Max retries reached, continuing with available movies\");\n                break;\n            }\n            retryCount = 0;\n            const html = await response.text();\n            const dom = new jsdom__WEBPACK_IMPORTED_MODULE_1__.JSDOM(html);\n            const doc = dom.window.document;\n            // Try different selectors for movie elements\n            const movieElements = doc.querySelectorAll(\".poster-container, .film-poster\");\n            console.log(`Found ${movieElements.length} movies on page ${currentPage}`);\n            if (movieElements.length === 0) {\n                console.log(\"No movies found on page, breaking loop\");\n                break;\n            }\n            // Check if there's a next page by looking at the pagination\n            const pagination = doc.querySelector(\".paginate-pages, .pagination\");\n            console.log(\"Pagination element found:\", !!pagination);\n            if (pagination) {\n                const lastPageLink = pagination.querySelector(\"li:last-child a, .paginate-last a\");\n                const totalPages = lastPageLink ? parseInt(lastPageLink.textContent) : 1;\n                console.log(`Total pages found: ${totalPages}`);\n                hasNextPage = currentPage < totalPages;\n            } else {\n                // If no pagination found, check for next button\n                const nextButton = doc.querySelector(\".paginate-next, .next\");\n                console.log(\"Next button found:\", !!nextButton);\n                hasNextPage = !!nextButton;\n            }\n            // Add all movies from this page\n            allMovies.push(...Array.from(movieElements));\n            console.log(`Total movies collected so far: ${allMovies.length}`);\n            if (hasNextPage) {\n                console.log(`Moving to page ${currentPage + 1}`);\n                currentPage++;\n            }\n        } catch (error) {\n            console.error(\"Error fetching page:\", error);\n            if (retryCount < maxRetries) {\n                retryCount++;\n                console.log(`Retrying page ${currentPage} (attempt ${retryCount}/${maxRetries})`);\n                await new Promise((resolve)=>setTimeout(resolve, delayBetweenRetries));\n                continue;\n            }\n            console.log(\"Max retries reached, continuing with available movies\");\n            break;\n        }\n    }\n    console.log(`Finished fetching all pages. Total movies found: ${allMovies.length}`);\n    return allMovies;\n}\nasync function GET(request) {\n    try {\n        const { searchParams } = new URL(request.url);\n        const listUrl = searchParams.get(\"url\");\n        if (!listUrl) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Please provide a Letterboxd list URL\"\n            }, {\n                status: 400\n            });\n        }\n        console.log(\"Fetching list:\", listUrl);\n        const movieElements = await fetchAllPages(listUrl);\n        console.log(\"Total movie elements found across all pages:\", movieElements.length);\n        if (movieElements.length === 0) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"No movies found in the list. Please make sure the list is public and accessible.\"\n            }, {\n                status: 404\n            });\n        }\n        const movies = await Promise.all(movieElements.map(async (element, index)=>{\n            const movieLink = element.querySelector(\"div[data-target-link]\");\n            const movieSlug = movieLink?.getAttribute(\"data-target-link\")?.split(\"/\")[2] || \"\";\n            if (!movieSlug) {\n                console.log(\"No movie slug found for element:\", element.outerHTML);\n                return null;\n            }\n            console.log(\"Processing movie with slug:\", movieSlug);\n            try {\n                const movieUrl = `https://letterboxd.com/film/${movieSlug}/`;\n                console.log(\"Fetching movie:\", movieUrl);\n                const movieResponse = await fetch(movieUrl, {\n                    headers: {\n                        \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36\",\n                        \"Accept\": \"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\",\n                        \"Accept-Language\": \"en-US,en;q=0.5\",\n                        \"Connection\": \"keep-alive\",\n                        \"Upgrade-Insecure-Requests\": \"1\",\n                        \"Cache-Control\": \"max-age=0\"\n                    }\n                });\n                if (!movieResponse.ok) {\n                    console.error(\"Failed to fetch movie:\", movieUrl, movieResponse.status);\n                    return null;\n                }\n                const movieHtml = await movieResponse.text();\n                const movieDom = new jsdom__WEBPACK_IMPORTED_MODULE_1__.JSDOM(movieHtml);\n                const movieDoc = movieDom.window.document;\n                const titleElement = movieDoc.querySelector(\"h1.headline-1\");\n                const title1 = titleElement?.textContent?.trim() || movieSlug.replace(/-/g, \" \");\n                const tmdbLink = movieDoc.querySelector('a[href*=\"themoviedb.org\"]');\n                const tmdbId = tmdbLink?.href?.match(/movie\\/(\\d+)/)?.[1];\n                console.log(\"Movie processing:\", {\n                    title: title1,\n                    tmdbId,\n                    hasTmdbLink: !!tmdbLink,\n                    tmdbLinkHref: tmdbLink?.href\n                });\n                const letterboxdApiUrl = `https://letterboxd.com/film/${movieSlug}/reviews/by/activity/`;\n                console.log(\"Fetching reviews from:\", letterboxdApiUrl);\n                let reviews = [];\n                try {\n                    const reviewsResponse = await fetch(letterboxdApiUrl, {\n                        headers: {\n                            \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36\",\n                            \"Accept\": \"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\",\n                            \"Accept-Language\": \"en-US,en;q=0.5\",\n                            \"Connection\": \"keep-alive\",\n                            \"Upgrade-Insecure-Requests\": \"1\",\n                            \"Cache-Control\": \"max-age=0\"\n                        }\n                    });\n                    console.log(\"Reviews response status:\", reviewsResponse.status);\n                    console.log(\"Reviews response ok:\", reviewsResponse.ok);\n                    console.log(\"Reviews response headers:\", Object.fromEntries(reviewsResponse.headers.entries()));\n                    if (reviewsResponse.ok) {\n                        const reviewsHtml = await reviewsResponse.text();\n                        console.log(\"Reviews HTML length:\", reviewsHtml.length);\n                        console.log(\"First 500 characters of HTML:\", reviewsHtml.substring(0, 500));\n                        const reviewsDom = new jsdom__WEBPACK_IMPORTED_MODULE_1__.JSDOM(reviewsHtml);\n                        const reviewsDoc = reviewsDom.window.document;\n                        const popularReviewsSection = reviewsDoc.querySelector(\".film-detail-content\");\n                        console.log(\"Found popular reviews section:\", !!popularReviewsSection);\n                        if (popularReviewsSection) {\n                            const reviewContainers = popularReviewsSection.querySelectorAll(\".film-detail\");\n                            console.log(\"Found review containers:\", reviewContainers.length);\n                            if (reviewContainers.length > 0) {\n                                reviews = Array.from(reviewContainers).map((container)=>{\n                                    const reviewText = container.querySelector(\".body-text\")?.textContent?.trim() || \"\";\n                                    const reviewerName = container.querySelector(\".name\")?.textContent?.trim() || \"Anonymous\";\n                                    const ratingElement = container.querySelector(\".rating\");\n                                    const rating = ratingElement ? parseFloat(ratingElement.textContent.trim()) : 0;\n                                    const dateElement = container.querySelector(\"time\");\n                                    const date = dateElement?.getAttribute(\"datetime\") || new Date().toISOString();\n                                    const avatarElement = container.querySelector(\".avatar\");\n                                    const avatarUrl = avatarElement?.src || null;\n                                    console.log(\"Processing review:\", {\n                                        reviewer: reviewerName,\n                                        hasContent: !!reviewText,\n                                        contentLength: reviewText.length,\n                                        rating,\n                                        date,\n                                        hasAvatar: !!avatarUrl,\n                                        containerHtml: container.innerHTML.substring(0, 200)\n                                    });\n                                    return {\n                                        id: container?.id || Math.random().toString(36).substr(2, 9),\n                                        reviewer: reviewerName,\n                                        rating,\n                                        date,\n                                        content: reviewText,\n                                        profilePath: avatarUrl\n                                    };\n                                }).filter((review)=>review.content.length > 0);\n                                reviews.sort((a, b)=>new Date(b.date) - new Date(a.date));\n                                reviews = reviews.slice(0, 6);\n                                console.log(\"Final processed reviews:\", reviews);\n                                console.log(\"Number of reviews after processing:\", reviews.length);\n                            } else {\n                                const mainContent = reviewsDoc.querySelector(\".film-detail-content\");\n                                if (mainContent) {\n                                    console.log(\"Found main content area, HTML structure:\", mainContent.innerHTML.substring(0, 500));\n                                }\n                                console.log(\"No review containers found. Available classes:\", Array.from(reviewsDoc.querySelectorAll(\"*\")).map((el)=>el.className).filter(Boolean).join(\", \"));\n                            }\n                        } else {\n                            console.log(\"No popular reviews section found. Available sections:\", Array.from(reviewsDoc.querySelectorAll(\"section\")).map((section)=>({\n                                    id: section.id,\n                                    class: section.className,\n                                    firstChild: section.firstElementChild?.className\n                                })));\n                        }\n                    } else {\n                        const errorText = await reviewsResponse.text();\n                        console.error(\"Failed to fetch reviews:\", {\n                            status: reviewsResponse.status,\n                            statusText: reviewsResponse.statusText,\n                            error: errorText\n                        });\n                    }\n                } catch (error) {\n                    console.error(\"Error fetching reviews:\", error);\n                }\n                let movieData = {\n                    id: index + 1,\n                    title: title1.charAt(0).toUpperCase() + title1.slice(1),\n                    year: null,\n                    director: \"Unknown Director\",\n                    directorProfilePath: null,\n                    posterUrl: \"https://s.ltrbxd.com/static/img/empty-poster-1000-D9cprv0m.png\",\n                    description: \"No description available\",\n                    rating: null,\n                    genres: [],\n                    cast: [],\n                    backdropUrl: null,\n                    runtime: null,\n                    releaseDate: null,\n                    tmdbId: null,\n                    movieSlug,\n                    reviews: reviews || []\n                };\n                if (tmdbId) {\n                    console.log(\"Fetching data for movie with TMDB ID:\", tmdbId);\n                    const tmdbUrl = `https://api.themoviedb.org/3/movie/${tmdbId}?api_key=2dca580c2a14b55200e784d157207b4d&append_to_response=credits`;\n                    console.log(\"Fetching movie details from:\", tmdbUrl);\n                    const tmdbResponse = await fetch(tmdbUrl, {\n                        headers: {\n                            \"Accept\": \"application/json\"\n                        }\n                    });\n                    if (tmdbResponse.ok) {\n                        const tmdbData = await tmdbResponse.json();\n                        console.log(\"TMDB movie data received:\", {\n                            title: tmdbData.title,\n                            hasCredits: !!tmdbData.credits,\n                            responseKeys: Object.keys(tmdbData)\n                        });\n                        const year = tmdbData.release_date?.split(\"-\")[0] || \"\";\n                        const directorData = tmdbData.credits?.crew?.find((person)=>person.job === \"Director\");\n                        const director = directorData?.name || \"Unknown Director\";\n                        const directorProfilePath = directorData?.profile_path ? `https://image.tmdb.org/t/p/w185${directorData.profile_path}` : null;\n                        const cast = tmdbData.credits?.cast?.map((actor)=>({\n                                name: actor.name,\n                                character: actor.character,\n                                profilePath: actor.profile_path ? `https://image.tmdb.org/t/p/w185${actor.profile_path}` : null,\n                                order: actor.order\n                            })).sort((a, b)=>a.order - b.order) || [];\n                        let description = \"No description available\";\n                        if (tmdbData.overview) {\n                            description = tmdbData.overview;\n                        } else {\n                            const letterboxdDescription = movieDoc.querySelector(\".text-sluglist + p, .text-sluglist + div p\");\n                            if (letterboxdDescription) {\n                                description = letterboxdDescription.textContent.trim();\n                            }\n                        }\n                        const rating = tmdbData.vote_average ? Math.round(tmdbData.vote_average * 10) / 10 : null;\n                        const genres = tmdbData.genres?.map((genre)=>genre.name) || [];\n                        const posterUrl = tmdbData.poster_path ? `https://image.tmdb.org/t/p/w500${tmdbData.poster_path}` : \"https://s.ltrbxd.com/static/img/empty-poster-1000-D9cprv0m.png\";\n                        const backdropUrl = tmdbData.backdrop_path ? `https://image.tmdb.org/t/p/original${tmdbData.backdrop_path}` : null;\n                        movieData = {\n                            ...movieData,\n                            year: parseInt(year) || null,\n                            director,\n                            directorProfilePath,\n                            posterUrl,\n                            description,\n                            rating,\n                            genres,\n                            cast,\n                            backdropUrl,\n                            runtime: tmdbData.runtime,\n                            releaseDate: tmdbData.release_date,\n                            tmdbId\n                        };\n                    }\n                }\n                console.log(\"Final movie data:\", movieData);\n                return movieData;\n            } catch (error) {\n                console.error(\"Error processing movie:\", movieSlug, error);\n                return {\n                    id: index + 1,\n                    title: title.charAt(0).toUpperCase() + title.slice(1),\n                    year: null,\n                    director: \"Unknown Director\",\n                    directorProfilePath: null,\n                    posterUrl: \"https://s.ltrbxd.com/static/img/empty-poster-1000-D9cprv0m.png\",\n                    description: \"No description available\",\n                    rating: null,\n                    genres: [],\n                    cast: [],\n                    backdropUrl: null,\n                    runtime: null,\n                    releaseDate: null,\n                    tmdbId: null,\n                    movieSlug,\n                    reviews: []\n                };\n            }\n        }));\n        const validMovies = movies.filter((movie)=>movie !== null);\n        const uniqueMovies = Array.from(new Map(validMovies.map((movie)=>[\n                movie.title,\n                movie\n            ])).values());\n        console.log(\"Final movies array:\", uniqueMovies.map((m)=>({\n                title: m.title,\n                slug: m.movieSlug\n            })));\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(uniqueMovies);\n    } catch (error) {\n        console.error(\"Error in API route:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: error.message || \"An unexpected error occurred\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LE1BQU1DLElBQUksQ0FBQyxJQUFJZ0ksSUFBSUgsWUFBWW5ILEdBQUcsQ0FBQ29ILENBQUFBLFFBQVM7Z0JBQUNBLE1BQU10RyxLQUFLO2dCQUFFc0c7YUFBTSxHQUFHRyxNQUFNO1FBRTlGOUosUUFBUUMsR0FBRyxDQUFDLHVCQUF1QjJKLGFBQWFySCxHQUFHLENBQUN3SCxDQUFBQSxJQUFNO2dCQUFFMUcsT0FBTzBHLEVBQUUxRyxLQUFLO2dCQUFFMkcsTUFBTUQsRUFBRXBILFNBQVM7WUFBQztRQUM5RixPQUFPMUQscURBQVlBLENBQUNtRCxJQUFJLENBQUN3SDtJQUUzQixFQUFFLE9BQU9uSixPQUFPO1FBQ2RULFFBQVFTLEtBQUssQ0FBQyx1QkFBdUJBO1FBQ3JDLE9BQU94QixxREFBWUEsQ0FBQ21ELElBQUksQ0FDdEI7WUFBRTNCLE9BQU9BLE1BQU13SixPQUFPLElBQUk7UUFBK0IsR0FDekQ7WUFBRXZKLFFBQVE7UUFBSTtJQUVsQjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbmV4dGZsaXgvLi9zcmMvYXBwL2FwaS9tb3ZpZXMvcm91dGUuanM/NzMzOSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0UmVzcG9uc2UgfSBmcm9tICduZXh0L3NlcnZlcic7XG5pbXBvcnQgeyBKU0RPTSB9IGZyb20gJ2pzZG9tJztcblxuYXN5bmMgZnVuY3Rpb24gZmV0Y2hBbGxQYWdlcyhsaXN0VXJsKSB7XG4gIGNvbnN0IGFsbE1vdmllcyA9IFtdO1xuICBsZXQgY3VycmVudFBhZ2UgPSAxO1xuICBsZXQgaGFzTmV4dFBhZ2UgPSB0cnVlO1xuICBsZXQgcmV0cnlDb3VudCA9IDA7XG4gIGNvbnN0IG1heFJldHJpZXMgPSAyO1xuICBjb25zdCBkZWxheUJldHdlZW5QYWdlcyA9IDIwMDA7XG4gIGNvbnN0IGRlbGF5QmV0d2VlblJldHJpZXMgPSAzMDAwO1xuXG4gIC8vIENoZWNrIGlmIGl0J3MgYSB3YXRjaGxpc3QgVVJMXG4gIGNvbnN0IGlzV2F0Y2hsaXN0ID0gbGlzdFVybC5pbmNsdWRlcygnL3dhdGNobGlzdCcpO1xuICBcbiAgd2hpbGUgKGhhc05leHRQYWdlKSB7XG4gICAgLy8gSGFuZGxlIHBhZ2luYXRpb24gVVJMIGZvcm1hdCBkaWZmZXJlbnRseSBmb3Igd2F0Y2hsaXN0c1xuICAgIGNvbnN0IHBhZ2VVcmwgPSBjdXJyZW50UGFnZSA9PT0gMSBcbiAgICAgID8gbGlzdFVybCBcbiAgICAgIDogaXNXYXRjaGxpc3QgXG4gICAgICAgID8gYCR7bGlzdFVybC5yZXBsYWNlKC9cXC8kLywgJycpfS9wYWdlLyR7Y3VycmVudFBhZ2V9L2BcbiAgICAgICAgOiBgJHtsaXN0VXJsfXBhZ2UvJHtjdXJyZW50UGFnZX0vYDtcbiAgICBcbiAgICBjb25zb2xlLmxvZygnRmV0Y2hpbmcgcGFnZTonLCBwYWdlVXJsKTtcbiAgICBcbiAgICB0cnkge1xuICAgICAgaWYgKGN1cnJlbnRQYWdlID4gMSkge1xuICAgICAgICBjb25zb2xlLmxvZyhgV2FpdGluZyAke2RlbGF5QmV0d2VlblBhZ2VzfW1zIGJlZm9yZSBmZXRjaGluZyBuZXh0IHBhZ2UuLi5gKTtcbiAgICAgICAgYXdhaXQgbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIGRlbGF5QmV0d2VlblBhZ2VzKSk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2gocGFnZVVybCwge1xuICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgJ1VzZXItQWdlbnQnOiAnTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV2luNjQ7IHg2NCkgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzkxLjAuNDQ3Mi4xMjQgU2FmYXJpLzUzNy4zNicsXG4gICAgICAgICAgJ0FjY2VwdCc6ICd0ZXh0L2h0bWwsYXBwbGljYXRpb24veGh0bWwreG1sLGFwcGxpY2F0aW9uL3htbDtxPTAuOSxpbWFnZS93ZWJwLCovKjtxPTAuOCcsXG4gICAgICAgICAgJ0FjY2VwdC1MYW5ndWFnZSc6ICdlbi1VUyxlbjtxPTAuNScsXG4gICAgICAgICAgJ0Nvbm5lY3Rpb24nOiAna2VlcC1hbGl2ZScsXG4gICAgICAgICAgJ1VwZ3JhZGUtSW5zZWN1cmUtUmVxdWVzdHMnOiAnMScsXG4gICAgICAgICAgJ0NhY2hlLUNvbnRyb2wnOiAnbWF4LWFnZT0wJ1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gZmV0Y2ggcGFnZTonLCBwYWdlVXJsLCByZXNwb25zZS5zdGF0dXMpO1xuICAgICAgICBpZiAocmV0cnlDb3VudCA8IG1heFJldHJpZXMpIHtcbiAgICAgICAgICByZXRyeUNvdW50Kys7XG4gICAgICAgICAgY29uc29sZS5sb2coYFJldHJ5aW5nIHBhZ2UgJHtjdXJyZW50UGFnZX0gKGF0dGVtcHQgJHtyZXRyeUNvdW50fS8ke21heFJldHJpZXN9KWApO1xuICAgICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCBkZWxheUJldHdlZW5SZXRyaWVzKSk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgY29uc29sZS5sb2coJ01heCByZXRyaWVzIHJlYWNoZWQsIGNvbnRpbnVpbmcgd2l0aCBhdmFpbGFibGUgbW92aWVzJyk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuXG4gICAgICByZXRyeUNvdW50ID0gMDtcbiAgICAgIGNvbnN0IGh0bWwgPSBhd2FpdCByZXNwb25zZS50ZXh0KCk7XG4gICAgICBjb25zdCBkb20gPSBuZXcgSlNET00oaHRtbCk7XG4gICAgICBjb25zdCBkb2MgPSBkb20ud2luZG93LmRvY3VtZW50O1xuXG4gICAgICAvLyBUcnkgZGlmZmVyZW50IHNlbGVjdG9ycyBmb3IgbW92aWUgZWxlbWVudHNcbiAgICAgIGNvbnN0IG1vdmllRWxlbWVudHMgPSBkb2MucXVlcnlTZWxlY3RvckFsbCgnLnBvc3Rlci1jb250YWluZXIsIC5maWxtLXBvc3RlcicpO1xuICAgICAgY29uc29sZS5sb2coYEZvdW5kICR7bW92aWVFbGVtZW50cy5sZW5ndGh9IG1vdmllcyBvbiBwYWdlICR7Y3VycmVudFBhZ2V9YCk7XG5cbiAgICAgIGlmIChtb3ZpZUVsZW1lbnRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICBjb25zb2xlLmxvZygnTm8gbW92aWVzIGZvdW5kIG9uIHBhZ2UsIGJyZWFraW5nIGxvb3AnKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG5cbiAgICAgIC8vIENoZWNrIGlmIHRoZXJlJ3MgYSBuZXh0IHBhZ2UgYnkgbG9va2luZyBhdCB0aGUgcGFnaW5hdGlvblxuICAgICAgY29uc3QgcGFnaW5hdGlvbiA9IGRvYy5xdWVyeVNlbGVjdG9yKCcucGFnaW5hdGUtcGFnZXMsIC5wYWdpbmF0aW9uJyk7XG4gICAgICBjb25zb2xlLmxvZygnUGFnaW5hdGlvbiBlbGVtZW50IGZvdW5kOicsICEhcGFnaW5hdGlvbik7XG4gICAgICBcbiAgICAgIGlmIChwYWdpbmF0aW9uKSB7XG4gICAgICAgIGNvbnN0IGxhc3RQYWdlTGluayA9IHBhZ2luYXRpb24ucXVlcnlTZWxlY3RvcignbGk6bGFzdC1jaGlsZCBhLCAucGFnaW5hdGUtbGFzdCBhJyk7XG4gICAgICAgIGNvbnN0IHRvdGFsUGFnZXMgPSBsYXN0UGFnZUxpbmsgPyBwYXJzZUludChsYXN0UGFnZUxpbmsudGV4dENvbnRlbnQpIDogMTtcbiAgICAgICAgY29uc29sZS5sb2coYFRvdGFsIHBhZ2VzIGZvdW5kOiAke3RvdGFsUGFnZXN9YCk7XG4gICAgICAgIGhhc05leHRQYWdlID0gY3VycmVudFBhZ2UgPCB0b3RhbFBhZ2VzO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gSWYgbm8gcGFnaW5hdGlvbiBmb3VuZCwgY2hlY2sgZm9yIG5leHQgYnV0dG9uXG4gICAgICAgIGNvbnN0IG5leHRCdXR0b24gPSBkb2MucXVlcnlTZWxlY3RvcignLnBhZ2luYXRlLW5leHQsIC5uZXh0Jyk7XG4gICAgICAgIGNvbnNvbGUubG9nKCdOZXh0IGJ1dHRvbiBmb3VuZDonLCAhIW5leHRCdXR0b24pO1xuICAgICAgICBoYXNOZXh0UGFnZSA9ICEhbmV4dEJ1dHRvbjtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gQWRkIGFsbCBtb3ZpZXMgZnJvbSB0aGlzIHBhZ2VcbiAgICAgIGFsbE1vdmllcy5wdXNoKC4uLkFycmF5LmZyb20obW92aWVFbGVtZW50cykpO1xuICAgICAgY29uc29sZS5sb2coYFRvdGFsIG1vdmllcyBjb2xsZWN0ZWQgc28gZmFyOiAke2FsbE1vdmllcy5sZW5ndGh9YCk7XG4gICAgICBcbiAgICAgIGlmIChoYXNOZXh0UGFnZSkge1xuICAgICAgICBjb25zb2xlLmxvZyhgTW92aW5nIHRvIHBhZ2UgJHtjdXJyZW50UGFnZSArIDF9YCk7XG4gICAgICAgIGN1cnJlbnRQYWdlKys7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIHBhZ2U6JywgZXJyb3IpO1xuICAgICAgaWYgKHJldHJ5Q291bnQgPCBtYXhSZXRyaWVzKSB7XG4gICAgICAgIHJldHJ5Q291bnQrKztcbiAgICAgICAgY29uc29sZS5sb2coYFJldHJ5aW5nIHBhZ2UgJHtjdXJyZW50UGFnZX0gKGF0dGVtcHQgJHtyZXRyeUNvdW50fS8ke21heFJldHJpZXN9KWApO1xuICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgZGVsYXlCZXR3ZWVuUmV0cmllcykpO1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cbiAgICAgIGNvbnNvbGUubG9nKCdNYXggcmV0cmllcyByZWFjaGVkLCBjb250aW51aW5nIHdpdGggYXZhaWxhYmxlIG1vdmllcycpO1xuICAgICAgYnJlYWs7XG4gICAgfVxuICB9XG5cbiAgY29uc29sZS5sb2coYEZpbmlzaGVkIGZldGNoaW5nIGFsbCBwYWdlcy4gVG90YWwgbW92aWVzIGZvdW5kOiAke2FsbE1vdmllcy5sZW5ndGh9YCk7XG4gIHJldHVybiBhbGxNb3ZpZXM7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBHRVQocmVxdWVzdCkge1xuICB0cnkge1xuICAgIGNvbnN0IHsgc2VhcmNoUGFyYW1zIH0gPSBuZXcgVVJMKHJlcXVlc3QudXJsKTtcbiAgICBjb25zdCBsaXN0VXJsID0gc2VhcmNoUGFyYW1zLmdldCgndXJsJyk7XG5cbiAgICBpZiAoIWxpc3RVcmwpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgeyBlcnJvcjogJ1BsZWFzZSBwcm92aWRlIGEgTGV0dGVyYm94ZCBsaXN0IFVSTCcgfSxcbiAgICAgICAgeyBzdGF0dXM6IDQwMCB9XG4gICAgICApO1xuICAgIH1cblxuICAgIGNvbnNvbGUubG9nKCdGZXRjaGluZyBsaXN0OicsIGxpc3RVcmwpO1xuICAgIFxuICAgIGNvbnN0IG1vdmllRWxlbWVudHMgPSBhd2FpdCBmZXRjaEFsbFBhZ2VzKGxpc3RVcmwpO1xuICAgIGNvbnNvbGUubG9nKCdUb3RhbCBtb3ZpZSBlbGVtZW50cyBmb3VuZCBhY3Jvc3MgYWxsIHBhZ2VzOicsIG1vdmllRWxlbWVudHMubGVuZ3RoKTtcblxuICAgIGlmIChtb3ZpZUVsZW1lbnRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICB7IGVycm9yOiAnTm8gbW92aWVzIGZvdW5kIGluIHRoZSBsaXN0LiBQbGVhc2UgbWFrZSBzdXJlIHRoZSBsaXN0IGlzIHB1YmxpYyBhbmQgYWNjZXNzaWJsZS4nIH0sXG4gICAgICAgIHsgc3RhdHVzOiA0MDQgfVxuICAgICAgKTtcbiAgICB9XG5cbiAgICBjb25zdCBtb3ZpZXMgPSBhd2FpdCBQcm9taXNlLmFsbChtb3ZpZUVsZW1lbnRzLm1hcChhc3luYyAoZWxlbWVudCwgaW5kZXgpID0+IHtcbiAgICAgIGNvbnN0IG1vdmllTGluayA9IGVsZW1lbnQucXVlcnlTZWxlY3RvcignZGl2W2RhdGEtdGFyZ2V0LWxpbmtdJyk7XG4gICAgICBjb25zdCBtb3ZpZVNsdWcgPSBtb3ZpZUxpbms/LmdldEF0dHJpYnV0ZSgnZGF0YS10YXJnZXQtbGluaycpPy5zcGxpdCgnLycpWzJdIHx8ICcnO1xuICAgICAgXG4gICAgICBpZiAoIW1vdmllU2x1Zykge1xuICAgICAgICBjb25zb2xlLmxvZygnTm8gbW92aWUgc2x1ZyBmb3VuZCBmb3IgZWxlbWVudDonLCBlbGVtZW50Lm91dGVySFRNTCk7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuXG4gICAgICBjb25zb2xlLmxvZygnUHJvY2Vzc2luZyBtb3ZpZSB3aXRoIHNsdWc6JywgbW92aWVTbHVnKTtcblxuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgbW92aWVVcmwgPSBgaHR0cHM6Ly9sZXR0ZXJib3hkLmNvbS9maWxtLyR7bW92aWVTbHVnfS9gO1xuICAgICAgICBjb25zb2xlLmxvZygnRmV0Y2hpbmcgbW92aWU6JywgbW92aWVVcmwpO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgbW92aWVSZXNwb25zZSA9IGF3YWl0IGZldGNoKG1vdmllVXJsLCB7XG4gICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgJ1VzZXItQWdlbnQnOiAnTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV2luNjQ7IHg2NCkgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzkxLjAuNDQ3Mi4xMjQgU2FmYXJpLzUzNy4zNicsXG4gICAgICAgICAgICAnQWNjZXB0JzogJ3RleHQvaHRtbCxhcHBsaWNhdGlvbi94aHRtbCt4bWwsYXBwbGljYXRpb24veG1sO3E9MC45LGltYWdlL3dlYnAsKi8qO3E9MC44JyxcbiAgICAgICAgICAgICdBY2NlcHQtTGFuZ3VhZ2UnOiAnZW4tVVMsZW47cT0wLjUnLFxuICAgICAgICAgICAgJ0Nvbm5lY3Rpb24nOiAna2VlcC1hbGl2ZScsXG4gICAgICAgICAgICAnVXBncmFkZS1JbnNlY3VyZS1SZXF1ZXN0cyc6ICcxJyxcbiAgICAgICAgICAgICdDYWNoZS1Db250cm9sJzogJ21heC1hZ2U9MCdcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGlmICghbW92aWVSZXNwb25zZS5vaykge1xuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBmZXRjaCBtb3ZpZTonLCBtb3ZpZVVybCwgbW92aWVSZXNwb25zZS5zdGF0dXMpO1xuICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgbW92aWVIdG1sID0gYXdhaXQgbW92aWVSZXNwb25zZS50ZXh0KCk7XG4gICAgICAgIGNvbnN0IG1vdmllRG9tID0gbmV3IEpTRE9NKG1vdmllSHRtbCk7XG4gICAgICAgIGNvbnN0IG1vdmllRG9jID0gbW92aWVEb20ud2luZG93LmRvY3VtZW50O1xuXG4gICAgICAgIGNvbnN0IHRpdGxlRWxlbWVudCA9IG1vdmllRG9jLnF1ZXJ5U2VsZWN0b3IoJ2gxLmhlYWRsaW5lLTEnKTtcbiAgICAgICAgY29uc3QgdGl0bGUgPSB0aXRsZUVsZW1lbnQ/LnRleHRDb250ZW50Py50cmltKCkgfHwgbW92aWVTbHVnLnJlcGxhY2UoLy0vZywgJyAnKTtcblxuICAgICAgICBjb25zdCB0bWRiTGluayA9IG1vdmllRG9jLnF1ZXJ5U2VsZWN0b3IoJ2FbaHJlZio9XCJ0aGVtb3ZpZWRiLm9yZ1wiXScpO1xuICAgICAgICBjb25zdCB0bWRiSWQgPSB0bWRiTGluaz8uaHJlZj8ubWF0Y2goL21vdmllXFwvKFxcZCspLyk/LlsxXTtcblxuICAgICAgICBjb25zb2xlLmxvZygnTW92aWUgcHJvY2Vzc2luZzonLCB7XG4gICAgICAgICAgdGl0bGUsXG4gICAgICAgICAgdG1kYklkLFxuICAgICAgICAgIGhhc1RtZGJMaW5rOiAhIXRtZGJMaW5rLFxuICAgICAgICAgIHRtZGJMaW5rSHJlZjogdG1kYkxpbms/LmhyZWZcbiAgICAgICAgfSk7XG5cbiAgICAgICAgY29uc3QgbGV0dGVyYm94ZEFwaVVybCA9IGBodHRwczovL2xldHRlcmJveGQuY29tL2ZpbG0vJHttb3ZpZVNsdWd9L3Jldmlld3MvYnkvYWN0aXZpdHkvYDtcbiAgICAgICAgY29uc29sZS5sb2coJ0ZldGNoaW5nIHJldmlld3MgZnJvbTonLCBsZXR0ZXJib3hkQXBpVXJsKTtcbiAgICAgICAgXG4gICAgICAgIGxldCByZXZpZXdzID0gW107XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgY29uc3QgcmV2aWV3c1Jlc3BvbnNlID0gYXdhaXQgZmV0Y2gobGV0dGVyYm94ZEFwaVVybCwge1xuICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAnVXNlci1BZ2VudCc6ICdNb3ppbGxhLzUuMCAoV2luZG93cyBOVCAxMC4wOyBXaW42NDsgeDY0KSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBDaHJvbWUvOTEuMC40NDcyLjEyNCBTYWZhcmkvNTM3LjM2JyxcbiAgICAgICAgICAgICAgJ0FjY2VwdCc6ICd0ZXh0L2h0bWwsYXBwbGljYXRpb24veGh0bWwreG1sLGFwcGxpY2F0aW9uL3htbDtxPTAuOSxpbWFnZS93ZWJwLCovKjtxPTAuOCcsXG4gICAgICAgICAgICAgICdBY2NlcHQtTGFuZ3VhZ2UnOiAnZW4tVVMsZW47cT0wLjUnLFxuICAgICAgICAgICAgICAnQ29ubmVjdGlvbic6ICdrZWVwLWFsaXZlJyxcbiAgICAgICAgICAgICAgJ1VwZ3JhZGUtSW5zZWN1cmUtUmVxdWVzdHMnOiAnMScsXG4gICAgICAgICAgICAgICdDYWNoZS1Db250cm9sJzogJ21heC1hZ2U9MCdcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIGNvbnNvbGUubG9nKCdSZXZpZXdzIHJlc3BvbnNlIHN0YXR1czonLCByZXZpZXdzUmVzcG9uc2Uuc3RhdHVzKTtcbiAgICAgICAgICBjb25zb2xlLmxvZygnUmV2aWV3cyByZXNwb25zZSBvazonLCByZXZpZXdzUmVzcG9uc2Uub2spO1xuICAgICAgICAgIGNvbnNvbGUubG9nKCdSZXZpZXdzIHJlc3BvbnNlIGhlYWRlcnM6JywgT2JqZWN0LmZyb21FbnRyaWVzKHJldmlld3NSZXNwb25zZS5oZWFkZXJzLmVudHJpZXMoKSkpO1xuXG4gICAgICAgICAgaWYgKHJldmlld3NSZXNwb25zZS5vaykge1xuICAgICAgICAgICAgY29uc3QgcmV2aWV3c0h0bWwgPSBhd2FpdCByZXZpZXdzUmVzcG9uc2UudGV4dCgpO1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ1Jldmlld3MgSFRNTCBsZW5ndGg6JywgcmV2aWV3c0h0bWwubGVuZ3RoKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdGaXJzdCA1MDAgY2hhcmFjdGVycyBvZiBIVE1MOicsIHJldmlld3NIdG1sLnN1YnN0cmluZygwLCA1MDApKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgY29uc3QgcmV2aWV3c0RvbSA9IG5ldyBKU0RPTShyZXZpZXdzSHRtbCk7XG4gICAgICAgICAgICBjb25zdCByZXZpZXdzRG9jID0gcmV2aWV3c0RvbS53aW5kb3cuZG9jdW1lbnQ7XG5cbiAgICAgICAgICAgIGNvbnN0IHBvcHVsYXJSZXZpZXdzU2VjdGlvbiA9IHJldmlld3NEb2MucXVlcnlTZWxlY3RvcignLmZpbG0tZGV0YWlsLWNvbnRlbnQnKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdGb3VuZCBwb3B1bGFyIHJldmlld3Mgc2VjdGlvbjonLCAhIXBvcHVsYXJSZXZpZXdzU2VjdGlvbik7XG5cbiAgICAgICAgICAgIGlmIChwb3B1bGFyUmV2aWV3c1NlY3Rpb24pIHtcbiAgICAgICAgICAgICAgY29uc3QgcmV2aWV3Q29udGFpbmVycyA9IHBvcHVsYXJSZXZpZXdzU2VjdGlvbi5xdWVyeVNlbGVjdG9yQWxsKCcuZmlsbS1kZXRhaWwnKTtcbiAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0ZvdW5kIHJldmlldyBjb250YWluZXJzOicsIHJldmlld0NvbnRhaW5lcnMubGVuZ3RoKTtcblxuICAgICAgICAgICAgICBpZiAocmV2aWV3Q29udGFpbmVycy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgcmV2aWV3cyA9IEFycmF5LmZyb20ocmV2aWV3Q29udGFpbmVycylcbiAgICAgICAgICAgICAgICAgIC5tYXAoY29udGFpbmVyID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcmV2aWV3VGV4dCA9IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcuYm9keS10ZXh0Jyk/LnRleHRDb250ZW50Py50cmltKCkgfHwgJyc7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBjb25zdCByZXZpZXdlck5hbWUgPSBjb250YWluZXIucXVlcnlTZWxlY3RvcignLm5hbWUnKT8udGV4dENvbnRlbnQ/LnRyaW0oKSB8fCAnQW5vbnltb3VzJztcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHJhdGluZ0VsZW1lbnQgPSBjb250YWluZXIucXVlcnlTZWxlY3RvcignLnJhdGluZycpO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCByYXRpbmcgPSByYXRpbmdFbGVtZW50ID8gcGFyc2VGbG9hdChyYXRpbmdFbGVtZW50LnRleHRDb250ZW50LnRyaW0oKSkgOiAwO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZGF0ZUVsZW1lbnQgPSBjb250YWluZXIucXVlcnlTZWxlY3RvcigndGltZScpO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBkYXRlID0gZGF0ZUVsZW1lbnQ/LmdldEF0dHJpYnV0ZSgnZGF0ZXRpbWUnKSB8fCBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCk7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBjb25zdCBhdmF0YXJFbGVtZW50ID0gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy5hdmF0YXInKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgYXZhdGFyVXJsID0gYXZhdGFyRWxlbWVudD8uc3JjIHx8IG51bGw7XG5cbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1Byb2Nlc3NpbmcgcmV2aWV3OicsIHtcbiAgICAgICAgICAgICAgICAgICAgICByZXZpZXdlcjogcmV2aWV3ZXJOYW1lLFxuICAgICAgICAgICAgICAgICAgICAgIGhhc0NvbnRlbnQ6ICEhcmV2aWV3VGV4dCxcbiAgICAgICAgICAgICAgICAgICAgICBjb250ZW50TGVuZ3RoOiByZXZpZXdUZXh0Lmxlbmd0aCxcbiAgICAgICAgICAgICAgICAgICAgICByYXRpbmcsXG4gICAgICAgICAgICAgICAgICAgICAgZGF0ZSxcbiAgICAgICAgICAgICAgICAgICAgICBoYXNBdmF0YXI6ICEhYXZhdGFyVXJsLFxuICAgICAgICAgICAgICAgICAgICAgIGNvbnRhaW5lckh0bWw6IGNvbnRhaW5lci5pbm5lckhUTUwuc3Vic3RyaW5nKDAsIDIwMClcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICBpZDogY29udGFpbmVyPy5pZCB8fCBNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KS5zdWJzdHIoMiwgOSksXG4gICAgICAgICAgICAgICAgICAgICAgcmV2aWV3ZXI6IHJldmlld2VyTmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICByYXRpbmcsXG4gICAgICAgICAgICAgICAgICAgICAgZGF0ZSxcbiAgICAgICAgICAgICAgICAgICAgICBjb250ZW50OiByZXZpZXdUZXh0LFxuICAgICAgICAgICAgICAgICAgICAgIHByb2ZpbGVQYXRoOiBhdmF0YXJVcmxcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAuZmlsdGVyKHJldmlldyA9PiByZXZpZXcuY29udGVudC5sZW5ndGggPiAwKTtcblxuICAgICAgICAgICAgICAgIHJldmlld3Muc29ydCgoYSwgYikgPT4gbmV3IERhdGUoYi5kYXRlKSAtIG5ldyBEYXRlKGEuZGF0ZSkpO1xuICAgICAgICAgICAgICAgIHJldmlld3MgPSByZXZpZXdzLnNsaWNlKDAsIDYpO1xuXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0ZpbmFsIHByb2Nlc3NlZCByZXZpZXdzOicsIHJldmlld3MpO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdOdW1iZXIgb2YgcmV2aWV3cyBhZnRlciBwcm9jZXNzaW5nOicsIHJldmlld3MubGVuZ3RoKTtcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb25zdCBtYWluQ29udGVudCA9IHJldmlld3NEb2MucXVlcnlTZWxlY3RvcignLmZpbG0tZGV0YWlsLWNvbnRlbnQnKTtcbiAgICAgICAgICAgICAgICBpZiAobWFpbkNvbnRlbnQpIHtcbiAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdGb3VuZCBtYWluIGNvbnRlbnQgYXJlYSwgSFRNTCBzdHJ1Y3R1cmU6JywgbWFpbkNvbnRlbnQuaW5uZXJIVE1MLnN1YnN0cmluZygwLCA1MDApKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ05vIHJldmlldyBjb250YWluZXJzIGZvdW5kLiBBdmFpbGFibGUgY2xhc3NlczonLCBcbiAgICAgICAgICAgICAgICAgIEFycmF5LmZyb20ocmV2aWV3c0RvYy5xdWVyeVNlbGVjdG9yQWxsKCcqJykpXG4gICAgICAgICAgICAgICAgICAgIC5tYXAoZWwgPT4gZWwuY2xhc3NOYW1lKVxuICAgICAgICAgICAgICAgICAgICAuZmlsdGVyKEJvb2xlYW4pXG4gICAgICAgICAgICAgICAgICAgIC5qb2luKCcsICcpXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgY29uc29sZS5sb2coJ05vIHBvcHVsYXIgcmV2aWV3cyBzZWN0aW9uIGZvdW5kLiBBdmFpbGFibGUgc2VjdGlvbnM6JywgXG4gICAgICAgICAgICAgICAgQXJyYXkuZnJvbShyZXZpZXdzRG9jLnF1ZXJ5U2VsZWN0b3JBbGwoJ3NlY3Rpb24nKSlcbiAgICAgICAgICAgICAgICAgIC5tYXAoc2VjdGlvbiA9PiAoe1xuICAgICAgICAgICAgICAgICAgICBpZDogc2VjdGlvbi5pZCxcbiAgICAgICAgICAgICAgICAgICAgY2xhc3M6IHNlY3Rpb24uY2xhc3NOYW1lLFxuICAgICAgICAgICAgICAgICAgICBmaXJzdENoaWxkOiBzZWN0aW9uLmZpcnN0RWxlbWVudENoaWxkPy5jbGFzc05hbWVcbiAgICAgICAgICAgICAgICAgIH0pKVxuICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zdCBlcnJvclRleHQgPSBhd2FpdCByZXZpZXdzUmVzcG9uc2UudGV4dCgpO1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGZldGNoIHJldmlld3M6Jywge1xuICAgICAgICAgICAgICBzdGF0dXM6IHJldmlld3NSZXNwb25zZS5zdGF0dXMsXG4gICAgICAgICAgICAgIHN0YXR1c1RleHQ6IHJldmlld3NSZXNwb25zZS5zdGF0dXNUZXh0LFxuICAgICAgICAgICAgICBlcnJvcjogZXJyb3JUZXh0XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgcmV2aWV3czonLCBlcnJvcik7XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgbW92aWVEYXRhID0ge1xuICAgICAgICAgIGlkOiBpbmRleCArIDEsXG4gICAgICAgICAgdGl0bGU6IHRpdGxlLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgdGl0bGUuc2xpY2UoMSksXG4gICAgICAgICAgeWVhcjogbnVsbCxcbiAgICAgICAgICBkaXJlY3RvcjogJ1Vua25vd24gRGlyZWN0b3InLFxuICAgICAgICAgIGRpcmVjdG9yUHJvZmlsZVBhdGg6IG51bGwsXG4gICAgICAgICAgcG9zdGVyVXJsOiAnaHR0cHM6Ly9zLmx0cmJ4ZC5jb20vc3RhdGljL2ltZy9lbXB0eS1wb3N0ZXItMTAwMC1EOWNwcnYwbS5wbmcnLFxuICAgICAgICAgIGRlc2NyaXB0aW9uOiAnTm8gZGVzY3JpcHRpb24gYXZhaWxhYmxlJyxcbiAgICAgICAgICByYXRpbmc6IG51bGwsXG4gICAgICAgICAgZ2VucmVzOiBbXSxcbiAgICAgICAgICBjYXN0OiBbXSxcbiAgICAgICAgICBiYWNrZHJvcFVybDogbnVsbCxcbiAgICAgICAgICBydW50aW1lOiBudWxsLFxuICAgICAgICAgIHJlbGVhc2VEYXRlOiBudWxsLFxuICAgICAgICAgIHRtZGJJZDogbnVsbCxcbiAgICAgICAgICBtb3ZpZVNsdWcsXG4gICAgICAgICAgcmV2aWV3czogcmV2aWV3cyB8fCBbXVxuICAgICAgICB9O1xuXG4gICAgICAgIGlmICh0bWRiSWQpIHtcbiAgICAgICAgICBjb25zb2xlLmxvZygnRmV0Y2hpbmcgZGF0YSBmb3IgbW92aWUgd2l0aCBUTURCIElEOicsIHRtZGJJZCk7XG4gICAgICAgICAgXG4gICAgICAgICAgY29uc3QgdG1kYlVybCA9IGBodHRwczovL2FwaS50aGVtb3ZpZWRiLm9yZy8zL21vdmllLyR7dG1kYklkfT9hcGlfa2V5PTJkY2E1ODBjMmExNGI1NTIwMGU3ODRkMTU3MjA3YjRkJmFwcGVuZF90b19yZXNwb25zZT1jcmVkaXRzYDtcbiAgICAgICAgICBjb25zb2xlLmxvZygnRmV0Y2hpbmcgbW92aWUgZGV0YWlscyBmcm9tOicsIHRtZGJVcmwpO1xuICAgICAgICAgIFxuICAgICAgICAgIGNvbnN0IHRtZGJSZXNwb25zZSA9IGF3YWl0IGZldGNoKHRtZGJVcmwsIHtcbiAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgJ0FjY2VwdCc6ICdhcHBsaWNhdGlvbi9qc29uJ1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgaWYgKHRtZGJSZXNwb25zZS5vaykge1xuICAgICAgICAgICAgY29uc3QgdG1kYkRhdGEgPSBhd2FpdCB0bWRiUmVzcG9uc2UuanNvbigpO1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ1RNREIgbW92aWUgZGF0YSByZWNlaXZlZDonLCB7XG4gICAgICAgICAgICAgIHRpdGxlOiB0bWRiRGF0YS50aXRsZSxcbiAgICAgICAgICAgICAgaGFzQ3JlZGl0czogISF0bWRiRGF0YS5jcmVkaXRzLFxuICAgICAgICAgICAgICByZXNwb25zZUtleXM6IE9iamVjdC5rZXlzKHRtZGJEYXRhKVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGNvbnN0IHllYXIgPSB0bWRiRGF0YS5yZWxlYXNlX2RhdGU/LnNwbGl0KCctJylbMF0gfHwgJyc7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGNvbnN0IGRpcmVjdG9yRGF0YSA9IHRtZGJEYXRhLmNyZWRpdHM/LmNyZXc/LmZpbmQocGVyc29uID0+IHBlcnNvbi5qb2IgPT09ICdEaXJlY3RvcicpO1xuICAgICAgICAgICAgY29uc3QgZGlyZWN0b3IgPSBkaXJlY3RvckRhdGE/Lm5hbWUgfHwgJ1Vua25vd24gRGlyZWN0b3InO1xuICAgICAgICAgICAgY29uc3QgZGlyZWN0b3JQcm9maWxlUGF0aCA9IGRpcmVjdG9yRGF0YT8ucHJvZmlsZV9wYXRoIFxuICAgICAgICAgICAgICA/IGBodHRwczovL2ltYWdlLnRtZGIub3JnL3QvcC93MTg1JHtkaXJlY3RvckRhdGEucHJvZmlsZV9wYXRofWBcbiAgICAgICAgICAgICAgOiBudWxsO1xuXG4gICAgICAgICAgICBjb25zdCBjYXN0ID0gdG1kYkRhdGEuY3JlZGl0cz8uY2FzdFxuICAgICAgICAgICAgICA/Lm1hcChhY3RvciA9PiAoe1xuICAgICAgICAgICAgICAgIG5hbWU6IGFjdG9yLm5hbWUsXG4gICAgICAgICAgICAgICAgY2hhcmFjdGVyOiBhY3Rvci5jaGFyYWN0ZXIsXG4gICAgICAgICAgICAgICAgcHJvZmlsZVBhdGg6IGFjdG9yLnByb2ZpbGVfcGF0aCBcbiAgICAgICAgICAgICAgICAgID8gYGh0dHBzOi8vaW1hZ2UudG1kYi5vcmcvdC9wL3cxODUke2FjdG9yLnByb2ZpbGVfcGF0aH1gXG4gICAgICAgICAgICAgICAgICA6IG51bGwsXG4gICAgICAgICAgICAgICAgb3JkZXI6IGFjdG9yLm9yZGVyXG4gICAgICAgICAgICAgIH0pKVxuICAgICAgICAgICAgICAuc29ydCgoYSwgYikgPT4gYS5vcmRlciAtIGIub3JkZXIpIHx8IFtdO1xuXG4gICAgICAgICAgICBsZXQgZGVzY3JpcHRpb24gPSAnTm8gZGVzY3JpcHRpb24gYXZhaWxhYmxlJztcbiAgICAgICAgICAgIGlmICh0bWRiRGF0YS5vdmVydmlldykge1xuICAgICAgICAgICAgICBkZXNjcmlwdGlvbiA9IHRtZGJEYXRhLm92ZXJ2aWV3O1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgY29uc3QgbGV0dGVyYm94ZERlc2NyaXB0aW9uID0gbW92aWVEb2MucXVlcnlTZWxlY3RvcignLnRleHQtc2x1Z2xpc3QgKyBwLCAudGV4dC1zbHVnbGlzdCArIGRpdiBwJyk7XG4gICAgICAgICAgICAgIGlmIChsZXR0ZXJib3hkRGVzY3JpcHRpb24pIHtcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbiA9IGxldHRlcmJveGREZXNjcmlwdGlvbi50ZXh0Q29udGVudC50cmltKCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc3QgcmF0aW5nID0gdG1kYkRhdGEudm90ZV9hdmVyYWdlIFxuICAgICAgICAgICAgICA/IE1hdGgucm91bmQodG1kYkRhdGEudm90ZV9hdmVyYWdlICogMTApIC8gMTAgXG4gICAgICAgICAgICAgIDogbnVsbDtcblxuICAgICAgICAgICAgY29uc3QgZ2VucmVzID0gdG1kYkRhdGEuZ2VucmVzPy5tYXAoZ2VucmUgPT4gZ2VucmUubmFtZSkgfHwgW107XG5cbiAgICAgICAgICAgIGNvbnN0IHBvc3RlclVybCA9IHRtZGJEYXRhLnBvc3Rlcl9wYXRoIFxuICAgICAgICAgICAgICA/IGBodHRwczovL2ltYWdlLnRtZGIub3JnL3QvcC93NTAwJHt0bWRiRGF0YS5wb3N0ZXJfcGF0aH1gXG4gICAgICAgICAgICAgIDogJ2h0dHBzOi8vcy5sdHJieGQuY29tL3N0YXRpYy9pbWcvZW1wdHktcG9zdGVyLTEwMDAtRDljcHJ2MG0ucG5nJztcblxuICAgICAgICAgICAgY29uc3QgYmFja2Ryb3BVcmwgPSB0bWRiRGF0YS5iYWNrZHJvcF9wYXRoXG4gICAgICAgICAgICAgID8gYGh0dHBzOi8vaW1hZ2UudG1kYi5vcmcvdC9wL29yaWdpbmFsJHt0bWRiRGF0YS5iYWNrZHJvcF9wYXRofWBcbiAgICAgICAgICAgICAgOiBudWxsO1xuXG4gICAgICAgICAgICBtb3ZpZURhdGEgPSB7XG4gICAgICAgICAgICAgIC4uLm1vdmllRGF0YSxcbiAgICAgICAgICAgICAgeWVhcjogcGFyc2VJbnQoeWVhcikgfHwgbnVsbCxcbiAgICAgICAgICAgICAgZGlyZWN0b3IsXG4gICAgICAgICAgICAgIGRpcmVjdG9yUHJvZmlsZVBhdGgsXG4gICAgICAgICAgICAgIHBvc3RlclVybCxcbiAgICAgICAgICAgICAgZGVzY3JpcHRpb24sXG4gICAgICAgICAgICAgIHJhdGluZyxcbiAgICAgICAgICAgICAgZ2VucmVzLFxuICAgICAgICAgICAgICBjYXN0LFxuICAgICAgICAgICAgICBiYWNrZHJvcFVybCxcbiAgICAgICAgICAgICAgcnVudGltZTogdG1kYkRhdGEucnVudGltZSxcbiAgICAgICAgICAgICAgcmVsZWFzZURhdGU6IHRtZGJEYXRhLnJlbGVhc2VfZGF0ZSxcbiAgICAgICAgICAgICAgdG1kYklkXG4gICAgICAgICAgICB9O1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnNvbGUubG9nKCdGaW5hbCBtb3ZpZSBkYXRhOicsIG1vdmllRGF0YSk7XG4gICAgICAgIHJldHVybiBtb3ZpZURhdGE7XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBwcm9jZXNzaW5nIG1vdmllOicsIG1vdmllU2x1ZywgZXJyb3IpO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGlkOiBpbmRleCArIDEsXG4gICAgICAgICAgdGl0bGU6IHRpdGxlLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgdGl0bGUuc2xpY2UoMSksXG4gICAgICAgICAgeWVhcjogbnVsbCxcbiAgICAgICAgICBkaXJlY3RvcjogJ1Vua25vd24gRGlyZWN0b3InLFxuICAgICAgICAgIGRpcmVjdG9yUHJvZmlsZVBhdGg6IG51bGwsXG4gICAgICAgICAgcG9zdGVyVXJsOiAnaHR0cHM6Ly9zLmx0cmJ4ZC5jb20vc3RhdGljL2ltZy9lbXB0eS1wb3N0ZXItMTAwMC1EOWNwcnYwbS5wbmcnLFxuICAgICAgICAgIGRlc2NyaXB0aW9uOiAnTm8gZGVzY3JpcHRpb24gYXZhaWxhYmxlJyxcbiAgICAgICAgICByYXRpbmc6IG51bGwsXG4gICAgICAgICAgZ2VucmVzOiBbXSxcbiAgICAgICAgICBjYXN0OiBbXSxcbiAgICAgICAgICBiYWNrZHJvcFVybDogbnVsbCxcbiAgICAgICAgICBydW50aW1lOiBudWxsLFxuICAgICAgICAgIHJlbGVhc2VEYXRlOiBudWxsLFxuICAgICAgICAgIHRtZGJJZDogbnVsbCxcbiAgICAgICAgICBtb3ZpZVNsdWcsXG4gICAgICAgICAgcmV2aWV3czogW11cbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICB9KSk7XG5cbiAgICBjb25zdCB2YWxpZE1vdmllcyA9IG1vdmllcy5maWx0ZXIobW92aWUgPT4gbW92aWUgIT09IG51bGwpO1xuICAgIGNvbnN0IHVuaXF1ZU1vdmllcyA9IEFycmF5LmZyb20obmV3IE1hcCh2YWxpZE1vdmllcy5tYXAobW92aWUgPT4gW21vdmllLnRpdGxlLCBtb3ZpZV0pKS52YWx1ZXMoKSk7XG5cbiAgICBjb25zb2xlLmxvZygnRmluYWwgbW92aWVzIGFycmF5OicsIHVuaXF1ZU1vdmllcy5tYXAobSA9PiAoeyB0aXRsZTogbS50aXRsZSwgc2x1ZzogbS5tb3ZpZVNsdWcgfSkpKTtcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24odW5pcXVlTW92aWVzKTtcblxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGluIEFQSSByb3V0ZTonLCBlcnJvcik7XG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgeyBlcnJvcjogZXJyb3IubWVzc2FnZSB8fCAnQW4gdW5leHBlY3RlZCBlcnJvciBvY2N1cnJlZCcgfSxcbiAgICAgIHsgc3RhdHVzOiA1MDAgfVxuICAgICk7XG4gIH1cbn0gIl0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsIkpTRE9NIiwiZmV0Y2hBbGxQYWdlcyIsImxpc3RVcmwiLCJhbGxNb3ZpZXMiLCJjdXJyZW50UGFnZSIsImhhc05leHRQYWdlIiwicmV0cnlDb3VudCIsIm1heFJldHJpZXMiLCJkZWxheUJldHdlZW5QYWdlcyIsImRlbGF5QmV0d2VlblJldHJpZXMiLCJpc1dhdGNobGlzdCIsImluY2x1ZGVzIiwicGFnZVVybCIsInJlcGxhY2UiLCJjb25zb2xlIiwibG9nIiwiUHJvbWlzZSIsInJlc29sdmUiLCJzZXRUaW1lb3V0IiwicmVzcG9uc2UiLCJmZXRjaCIsImhlYWRlcnMiLCJvayIsImVycm9yIiwic3RhdHVzIiwiaHRtbCIsInRleHQiLCJkb20iLCJkb2MiLCJ3aW5kb3ciLCJkb2N1bWVudCIsIm1vdmllRWxlbWVudHMiLCJxdWVyeVNlbGVjdG9yQWxsIiwibGVuZ3RoIiwicGFnaW5hdGlvbiIsInF1ZXJ5U2VsZWN0b3IiLCJsYXN0UGFnZUxpbmsiLCJ0b3RhbFBhZ2VzIiwicGFyc2VJbnQiLCJ0ZXh0Q29udGVudCIsIm5leHRCdXR0b24iLCJwdXNoIiwiQXJyYXkiLCJmcm9tIiwiR0VUIiwicmVxdWVzdCIsInNlYXJjaFBhcmFtcyIsIlVSTCIsInVybCIsImdldCIsImpzb24iLCJtb3ZpZXMiLCJhbGwiLCJtYXAiLCJlbGVtZW50IiwiaW5kZXgiLCJtb3ZpZUxpbmsiLCJtb3ZpZVNsdWciLCJnZXRBdHRyaWJ1dGUiLCJzcGxpdCIsIm91dGVySFRNTCIsIm1vdmllVXJsIiwibW92aWVSZXNwb25zZSIsIm1vdmllSHRtbCIsIm1vdmllRG9tIiwibW92aWVEb2MiLCJ0aXRsZUVsZW1lbnQiLCJ0aXRsZSIsInRyaW0iLCJ0bWRiTGluayIsInRtZGJJZCIsImhyZWYiLCJtYXRjaCIsImhhc1RtZGJMaW5rIiwidG1kYkxpbmtIcmVmIiwibGV0dGVyYm94ZEFwaVVybCIsInJldmlld3MiLCJyZXZpZXdzUmVzcG9uc2UiLCJPYmplY3QiLCJmcm9tRW50cmllcyIsImVudHJpZXMiLCJyZXZpZXdzSHRtbCIsInN1YnN0cmluZyIsInJldmlld3NEb20iLCJyZXZpZXdzRG9jIiwicG9wdWxhclJldmlld3NTZWN0aW9uIiwicmV2aWV3Q29udGFpbmVycyIsImNvbnRhaW5lciIsInJldmlld1RleHQiLCJyZXZpZXdlck5hbWUiLCJyYXRpbmdFbGVtZW50IiwicmF0aW5nIiwicGFyc2VGbG9hdCIsImRhdGVFbGVtZW50IiwiZGF0ZSIsIkRhdGUiLCJ0b0lTT1N0cmluZyIsImF2YXRhckVsZW1lbnQiLCJhdmF0YXJVcmwiLCJzcmMiLCJyZXZpZXdlciIsImhhc0NvbnRlbnQiLCJjb250ZW50TGVuZ3RoIiwiaGFzQXZhdGFyIiwiY29udGFpbmVySHRtbCIsImlubmVySFRNTCIsImlkIiwiTWF0aCIsInJhbmRvbSIsInRvU3RyaW5nIiwic3Vic3RyIiwiY29udGVudCIsInByb2ZpbGVQYXRoIiwiZmlsdGVyIiwicmV2aWV3Iiwic29ydCIsImEiLCJiIiwic2xpY2UiLCJtYWluQ29udGVudCIsImVsIiwiY2xhc3NOYW1lIiwiQm9vbGVhbiIsImpvaW4iLCJzZWN0aW9uIiwiY2xhc3MiLCJmaXJzdENoaWxkIiwiZmlyc3RFbGVtZW50Q2hpbGQiLCJlcnJvclRleHQiLCJzdGF0dXNUZXh0IiwibW92aWVEYXRhIiwiY2hhckF0IiwidG9VcHBlckNhc2UiLCJ5ZWFyIiwiZGlyZWN0b3IiLCJkaXJlY3RvclByb2ZpbGVQYXRoIiwicG9zdGVyVXJsIiwiZGVzY3JpcHRpb24iLCJnZW5yZXMiLCJjYXN0IiwiYmFja2Ryb3BVcmwiLCJydW50aW1lIiwicmVsZWFzZURhdGUiLCJ0bWRiVXJsIiwidG1kYlJlc3BvbnNlIiwidG1kYkRhdGEiLCJoYXNDcmVkaXRzIiwiY3JlZGl0cyIsInJlc3BvbnNlS2V5cyIsImtleXMiLCJyZWxlYXNlX2RhdGUiLCJkaXJlY3RvckRhdGEiLCJjcmV3IiwiZmluZCIsInBlcnNvbiIsImpvYiIsIm5hbWUiLCJwcm9maWxlX3BhdGgiLCJhY3RvciIsImNoYXJhY3RlciIsIm9yZGVyIiwib3ZlcnZpZXciLCJsZXR0ZXJib3hkRGVzY3JpcHRpb24iLCJ2b3RlX2F2ZXJhZ2UiLCJyb3VuZCIsImdlbnJlIiwicG9zdGVyX3BhdGgiLCJiYWNrZHJvcF9wYXRoIiwidmFsaWRNb3ZpZXMiLCJtb3ZpZSIsInVuaXF1ZU1vdmllcyIsIk1hcCIsInZhbHVlcyIsIm0iLCJzbHVnIiwibWVzc2FnZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/movies/route.js\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fmovies%2Froute&page=%2Fapi%2Fmovies%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fmovies%2Froute.js&appDir=%2FUsers%2Fguzmancura%2FDesktop%2Fnextflix%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fguzmancura%2FDesktop%2Fnextflix&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();